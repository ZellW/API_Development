library(rpart)
library(jsonlite)
load("Decision_Tree_German_Credit.RData")

#* @post /predict
predict.default.rate <- function(
     Status.of.existing.checking.account
     , Duration.in.month
     , Credit.history
     , Savings.account.bonds
) {
     data <- list(
          Status.of.existing.checking.account=Status.of.existing.checking.account
          , Duration.in.month=Duration.in.month
          , Credit.history=Credit.history
          , Savings.account.bonds=Savings.account.bonds
     )
     prediction <- predict(decision.tree, data)
     return(list(default.probability=unbox(prediction[1, 2])))
}


# Please have an empty last line in the end; otherwise, you will see this error 
# when starting a webserver

